<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quickstart with Slice Prediction &#8212; AI Surrogate Models for Engineering on AWS 0.1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=9de7e953" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=06097142" />
    <script src="../_static/documentation_options.js?v=a58bc63e"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Troubleshooting" href="troubleshooting.html" />
    <link rel="prev" title="Quickstart with Surface Variable Prediction" href="quickstart-surface.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="quickstart-with-slice-prediction">
<span id="quickstart-slices"></span><h1>Quickstart with Slice Prediction<a class="headerlink" href="#quickstart-with-slice-prediction" title="Link to this heading">¶</a></h1>
<p>To get started, first make sure that:</p>
<ul class="simple">
<li><p>MLSimKit is <a class="reference internal" href="install.html#install"><span class="std std-ref">installed</span></a></p></li>
</ul>
<p>We’ll use a sample dataset to quickly show you an end-to-end workflow.</p>
<p>Slice prediction is accessed via the <code class="docutils literal notranslate"><span class="pre">mlsimkit-learn</span> <span class="pre">slices</span></code> command</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[MLSimKit] Learning Tools
Usage: mlsimkit-learn slices [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                             [ARGS]...]...

  Use Case: Slice Prediction

  Slice Prediction is used to predict parameters from slices for 3D geometry
  meshes...

Options:
  --help  Show this message and exit.

Commands:
  preprocess             Step (1): Process input data and prepare manifests
  train-image-encoder    Step (2): Train image encoding model
  process-mesh-data      Step (3): Link the geometry and image training data
  train-prediction       Step (4): Train prediction using encoder outputs
  predict                Step (5): Predict results and evaluate performance
  inspect-image-encoder  (Debug): Evaluate image encoder performance
</pre></div>
</div>
<p>There are five steps to run the pipeline through preprocessing, training, and then prediction. You may run commands separately. For convenience, you can run one or more commands including the entire pipeline using YAML config files.</p>
<p>You may provide a config by running:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mlsimkit-learn<span class="w"> </span>--config<span class="w"> </span>&lt;config&gt;<span class="w"> </span>slices<span class="w"> </span>&lt;command-name&gt;<span class="w"> </span>&lt;command-name&gt;<span class="w"> </span>...
</pre></div>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">help</span></code> command to see options and the definitions of hyperparameters. For example, the following command will display all hyperparameters for a training step:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mlsimkit-learn<span class="w"> </span>slices<span class="w"> </span>train-image-encoder<span class="w"> </span>--help
</pre></div>
</div>
<section id="sample-dataset">
<h2>Sample Dataset<a class="headerlink" href="#sample-dataset" title="Link to this heading">¶</a></h2>
<p>There is a sample config and a very small sample dataset called “ahmed-sample” so you can run end-to-end quickly:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>src/mlsimkit/conf
└──<span class="w"> </span>slices
<span class="w">    </span>└──<span class="w"> </span>sample.yaml

src/mlsimkit/datasets
├──<span class="w"> </span>...
└──<span class="w"> </span>ahmed-sample
<span class="w">    </span>├──<span class="w"> </span>downsampled_stls
<span class="w">    </span>├──<span class="w"> </span>slice_images
<span class="w">    </span>└──<span class="w"> </span>slices.manifest
</pre></div>
</div>
</section>
<section id="external-datasets">
<h2>External Datasets<a class="headerlink" href="#external-datasets" title="Link to this heading">¶</a></h2>
<p>In addition to the sample dataset, there are tutorials to get started with publicly available datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>tutorials/
└── slices
    ├── ahmed/
    ├── drivaer/
    ├── sample/
    └── windsor/
</pre></div>
</div>
</section>
<section id="run-the-sample">
<h2>Run the Sample<a class="headerlink" href="#run-the-sample" title="Link to this heading">¶</a></h2>
<p>First, make a folder for all the outputs. Replace <code class="docutils literal notranslate"><span class="pre">--output-dir</span> <span class="pre">quickstart/slices</span></code> in the command below with your own folder location.</p>
<p>Second, run the entire train-predict pipeline to make predictions on the sample data:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mlsimkit-learn<span class="w"> </span>--output-dir<span class="w"> </span>quickstart/slices<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--config<span class="w"> </span>src/mlsimkit/conf/slices/sample.yaml<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>slices<span class="w"> </span>preprocess<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>train-image-encoder<span class="w"> </span>--device<span class="w"> </span>cpu<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>inspect-image-encoder<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>process-mesh-data<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>train-prediction<span class="w"> </span>--device<span class="w"> </span>cpu<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>predict
</pre></div>
</div>
<p>Also, note that commands can be chained together.  For example, the above runs <cite>preprocess</cite>, <cite>train-image-encoder</cite>, <cite>inspect-image-encoder</cite>, <cite>process-mesh-data</cite>, <cite>train-prediction</cite>, and then <cite>predict</cite>.</p>
<section id="running-on-gpu">
<h3>Running on GPU<a class="headerlink" href="#running-on-gpu" title="Link to this heading">¶</a></h3>
<p>MLSimKit automatically uses a GPU by default. To use your GPU, remove <code class="docutils literal notranslate"><span class="pre">--device</span> <span class="pre">cpu</span></code> from the previous command and run again:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mlsimkit-learn<span class="w"> </span>--output-dir<span class="w"> </span>quickstart/slices<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--config<span class="w"> </span>src/mlsimkit/conf/slices/sample.yaml<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>slices<span class="w"> </span>preprocess<span class="w"> </span>train-image-encoder<span class="w"> </span>inspect-image-encoder<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>process-mesh-data<span class="w"> </span>train-prediction<span class="w"> </span>predict
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On older MacOS hardware, you may see the error <code class="docutils literal notranslate"><span class="pre">Cannot</span> <span class="pre">convert</span> <span class="pre">a</span> <span class="pre">MPS</span> <span class="pre">Tensor</span> <span class="pre">to</span> <span class="pre">float64</span> <span class="pre">dtype</span></code>. If so, force CPU by specifying <code class="docutils literal notranslate"><span class="pre">--device</span> <span class="pre">cpu</span></code> for the train commands.</p>
<p>In general, please see the <a class="reference internal" href="troubleshooting.html#troubleshooting"><span class="std std-ref">Troubleshooting</span></a> guide for possible errors if commands do not work.</p>
</div>
<p>All artifacts are written into the output directory <code class="docutils literal notranslate"><span class="pre">--output-dir</span></code>. You may also set the output directory in the config file. Commands automatically share paths to the output artifacts such as the train model path. The sample configuration below sets some input options but most options use defaults. There are many options, which we go into detail after the quickstart.</p>
<p>The sample configuration <code class="docutils literal notranslate"><span class="pre">conf/slices/sample.yaml</span></code> looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">slices</span><span class="p">:</span>
<span class="w"> </span><span class="nt">preprocess</span><span class="p">:</span>
<span class="w">   </span><span class="c1"># path is relative to mlsimkit/datasets, which is the default search path</span>
<span class="w">   </span><span class="nt">manifest-uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ahmed-sample/slices.manifest</span>

<span class="w">   </span><span class="c1"># split the dataset into three</span>
<span class="w">   </span><span class="nt">train-size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.6</span>
<span class="w">   </span><span class="nt">valid-size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
<span class="w">   </span><span class="nt">test-size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>

<span class="w"> </span><span class="nt">train-image-encoder</span><span class="p">:</span>
<span class="w">   </span><span class="nt">batch-size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">   </span><span class="c1"># small for quickstart sample, use larger normally. See user guide.</span>

<span class="w"> </span><span class="nt">train-prediction</span><span class="p">:</span>
<span class="w">   </span><span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w">      </span><span class="c1"># low number for sample quickstart</span>
<span class="w">   </span><span class="nt">batch-size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">   </span><span class="c1"># small for quickstart sample, use larger normally. See user guide.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A “manifest” describes the paths to a dataset and is used to share data between tasks for a particular prediction use case like Slices. For now, know that <code class="docutils literal notranslate"><span class="pre">ahmed-sample/slices.manifest</span></code> references a small dataset packaged with MLSimKit.</p>
</div>
<p>You will see console logging something like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span>MLSimKit<span class="o">]</span><span class="w"> </span>Learning<span class="w"> </span>Tools
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Package<span class="w"> </span>Version:<span class="w"> </span><span class="m">0</span>.2.3.dev3+gaf49957.d20240808
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="s1">&#39;preprocess&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Preprocessing<span class="w"> </span>manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/src/mlsimkit/datasets/ahmed-sample/slices.manifest&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Image<span class="w"> </span>data<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-0.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Image<span class="w"> </span>data<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-1.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Image<span class="w"> </span>data<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-2.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Image<span class="w"> </span>data<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-3.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Image<span class="w"> </span>data<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-4.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Image<span class="w"> </span>data<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-5.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Image<span class="w"> </span>data<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-6.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices-copy.manifest&#39;</span><span class="w"> </span>written<span class="w"> </span><span class="o">(</span><span class="m">7</span><span class="w"> </span>records<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Splitting<span class="w"> </span>manifest<span class="w"> </span>into<span class="w"> </span>train-size<span class="o">=</span><span class="m">0</span>.6<span class="w"> </span>valid-size<span class="o">=</span><span class="m">0</span>.2<span class="w"> </span>test-size<span class="o">=</span><span class="m">0</span>.2
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/train.manifest&#39;</span><span class="w"> </span>written<span class="w"> </span><span class="o">(</span><span class="m">4</span><span class="w"> </span>records<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/validate.manifest&#39;</span><span class="w"> </span>written<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>records<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/test.manifest&#39;</span><span class="w"> </span>written<span class="w"> </span><span class="o">(</span><span class="m">2</span><span class="w"> </span>records<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="s1">&#39;train-image-encoder&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training<span class="w"> </span>state<span class="w"> </span>configuration:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;Distributed&quot;</span>:<span class="w"> </span><span class="s2">&quot;no&quot;</span>,<span class="w"> </span><span class="s2">&quot;Num processes&quot;</span>:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="s2">&quot;Process index&quot;</span>:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="s2">&quot;Local process index&quot;</span>:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="s2">&quot;Device&quot;</span>:<span class="w"> </span><span class="s2">&quot;cuda&quot;</span>,<span class="w"> </span><span class="s2">&quot;Mixed precision&quot;</span>:<span class="w"> </span><span class="s2">&quot;no&quot;</span><span class="o">}</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training<span class="w"> </span>started<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;model&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Train<span class="w"> </span>dataset<span class="w"> </span>size:<span class="w"> </span><span class="m">4</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Validation<span class="w"> </span>dataset<span class="w"> </span>size:<span class="w"> </span><span class="m">1</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">   </span><span class="m">0</span>%<span class="p">|</span><span class="w">                                                          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/5<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">0</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">52558</span>.26172<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">39234</span>.75781<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>inf
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/training_output/checkpoint_models/model_epoch0.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">20</span>%<span class="p">|</span>██████████<span class="w">                                        </span><span class="p">|</span><span class="w"> </span><span class="m">1</span>/5<span class="w"> </span><span class="o">[</span><span class="m">00</span>:01&lt;<span class="m">00</span>:07,<span class="w">  </span><span class="m">1</span>.90s/epochs<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">57753</span>.22656<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">38050</span>.39453<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">39234</span>.75781
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">40</span>%<span class="p">|</span>████████████████████<span class="w">                              </span><span class="p">|</span><span class="w"> </span><span class="m">2</span>/5<span class="w"> </span><span class="o">[</span><span class="m">00</span>:02&lt;<span class="m">00</span>:03,<span class="w">  </span><span class="m">1</span>.01s/epochs<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">54896</span>.26172<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">45074</span>.37891<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">38050</span>.39453
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">1</span><span class="w"> </span>had<span class="w"> </span>the<span class="w"> </span>minimum<span class="w"> </span>validation<span class="w"> </span>loss.
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">60</span>%<span class="p">|</span>██████████████████████████████<span class="w">                    </span><span class="p">|</span><span class="w"> </span><span class="m">3</span>/5<span class="w"> </span><span class="o">[</span><span class="m">00</span>:02&lt;<span class="m">00</span>:01,<span class="w">  </span><span class="m">1</span>.42epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">3</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">51979</span>.10156<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">39109</span>.33984<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">38050</span>.39453
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">1</span><span class="w"> </span>had<span class="w"> </span>the<span class="w"> </span>minimum<span class="w"> </span>validation<span class="w"> </span>loss.
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">80</span>%<span class="p">|</span>████████████████████████████████████████<span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">4</span>/5<span class="w"> </span><span class="o">[</span><span class="m">00</span>:02&lt;<span class="m">00</span>:00,<span class="w">  </span><span class="m">1</span>.84epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">4</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">48421</span>.11719<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">39321</span>.71875<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">38050</span>.39453
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">1</span><span class="w"> </span>had<span class="w"> </span>the<span class="w"> </span>minimum<span class="w"> </span>validation<span class="w"> </span>loss.
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/training_output/last_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w"> </span><span class="m">100</span>%<span class="p">|</span>██████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">5</span>/5<span class="w"> </span><span class="o">[</span><span class="m">00</span>:02&lt;<span class="m">00</span>:00,<span class="w">  </span><span class="m">1</span>.97epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>model:<span class="w"> </span><span class="m">2</span>.720<span class="w"> </span>seconds<span class="w"> </span>/<span class="w"> </span><span class="m">0</span>.045<span class="w"> </span>minutes
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Minimum<span class="w"> </span>validation<span class="w"> </span>loss:<span class="w"> </span><span class="m">38050</span>.39453
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Minimum<span class="w"> </span>train<span class="w"> </span>loss:<span class="w"> </span><span class="m">48421</span>.11719
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training<span class="w"> </span>Completed
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Total<span class="w"> </span>training<span class="w"> </span>time:<span class="w"> </span><span class="m">2</span>.730<span class="w"> </span>seconds<span class="w"> </span>/<span class="w"> </span><span class="m">0</span>.046<span class="w"> </span>minutes
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="s1">&#39;inspect-image-encoder&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span>inference<span class="w"> </span>on<span class="w"> </span>model<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Generating<span class="w"> </span>images<span class="w"> </span><span class="nv">frames</span><span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="nv">channels</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">size</span><span class="o">=(</span><span class="m">128</span>,<span class="w"> </span><span class="m">128</span><span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Result<span class="w"> </span>metrics:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;mse&#39;</span>:<span class="w"> </span><span class="m">0</span>.09836520999670029,<span class="w"> </span><span class="s1">&#39;mae&#39;</span>:<span class="w"> </span><span class="m">0</span>.2959270179271698,<span class="w"> </span><span class="s1">&#39;mape&#39;</span>:<span class="w"> </span><span class="m">1</span>.5198930501937866,<span class="w"> </span><span class="s1">&#39;msle&#39;</span>:<span class="w"> </span><span class="m">0</span>.04955117776989937,<span class="w"> </span><span class="s1">&#39;psnr&#39;</span>:<span class="w"> </span><span class="m">7</span>.8740850350534455<span class="o">}</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Result<span class="w"> </span>metrics:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;mse&#39;</span>:<span class="w"> </span><span class="m">0</span>.09724471718072891,<span class="w"> </span><span class="s1">&#39;mae&#39;</span>:<span class="w"> </span><span class="m">0</span>.29339802265167236,<span class="w"> </span><span class="s1">&#39;mape&#39;</span>:<span class="w"> </span><span class="m">1</span>.5099842548370361,<span class="w"> </span><span class="s1">&#39;msle&#39;</span>:<span class="w"> </span><span class="m">0</span>.049076326191425323,<span class="w"> </span><span class="s1">&#39;psnr&#39;</span>:<span class="w"> </span><span class="m">7</span>.9238399347884805<span class="o">}</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Result<span class="w"> </span>metrics:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;mse&#39;</span>:<span class="w"> </span><span class="m">0</span>.09833560138940811,<span class="w"> </span><span class="s1">&#39;mae&#39;</span>:<span class="w"> </span><span class="m">0</span>.2956932485103607,<span class="w"> </span><span class="s1">&#39;mape&#39;</span>:<span class="w"> </span><span class="m">1</span>.5212063789367676,<span class="w"> </span><span class="s1">&#39;msle&#39;</span>:<span class="w"> </span><span class="m">0</span>.049564674496650696,<span class="w"> </span><span class="s1">&#39;psnr&#39;</span>:<span class="w"> </span><span class="m">7</span>.875391758675056<span class="o">}</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Result<span class="w"> </span>metrics:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;mse&#39;</span>:<span class="w"> </span><span class="m">0</span>.0982661321759224,<span class="w"> </span><span class="s1">&#39;mae&#39;</span>:<span class="w"> </span><span class="m">0</span>.29574644565582275,<span class="w"> </span><span class="s1">&#39;mape&#39;</span>:<span class="w"> </span><span class="m">1</span>.5169732570648193,<span class="w"> </span><span class="s1">&#39;msle&#39;</span>:<span class="w"> </span><span class="m">0</span>.049490440636873245,<span class="w"> </span><span class="s1">&#39;psnr&#39;</span>:<span class="w"> </span><span class="m">7</span>.878460798940074<span class="o">}</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Images<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/inference_output/images&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Results<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/inference_output/results.jsonl&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="s1">&#39;process-mesh-data&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Processing<span class="w"> </span>manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/train.manifest&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Encoding<span class="w"> </span>written<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/inference_output/geometry-group-5.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Encoding<span class="w"> </span>written<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/inference_output/geometry-group-3.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Encoding<span class="w"> </span>written<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/inference_output/geometry-group-4.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Encoding<span class="w"> </span>written<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/inference_output/geometry-group-2.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/train.manifest&#39;</span><span class="w"> </span>written<span class="w"> </span><span class="o">(</span><span class="m">4</span><span class="w"> </span>records<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Processing<span class="w"> </span>manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/validate.manifest&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Encoding<span class="w"> </span>written<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/ae/inference_output/geometry-group-0.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Manifest<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/validate.manifest&#39;</span><span class="w"> </span>written<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>records<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="s1">&#39;train-prediction&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training<span class="w"> </span>state<span class="w"> </span>configuration:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;Distributed&quot;</span>:<span class="w"> </span><span class="s2">&quot;no&quot;</span>,<span class="w"> </span><span class="s2">&quot;Num processes&quot;</span>:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="s2">&quot;Process index&quot;</span>:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="s2">&quot;Local process index&quot;</span>:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="s2">&quot;Device&quot;</span>:<span class="w"> </span><span class="s2">&quot;cuda&quot;</span>,<span class="w"> </span><span class="s2">&quot;Mixed precision&quot;</span>:<span class="w"> </span><span class="s2">&quot;no&quot;</span><span class="o">}</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training<span class="w"> </span>started<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;model&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Train<span class="w"> </span>dataset<span class="w"> </span>size:<span class="w"> </span><span class="m">4</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Validation<span class="w"> </span>dataset<span class="w"> </span>size:<span class="w"> </span><span class="m">1</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">   </span><span class="m">0</span>%<span class="p">|</span><span class="w">                                                         </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">0</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>.07725<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.82969<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>inf
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/checkpoint_models/model_epoch0.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">10</span>%<span class="p">|</span>████▉<span class="w">                                            </span><span class="p">|</span><span class="w"> </span><span class="m">1</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:06,<span class="w">  </span><span class="m">1</span>.30epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.61467<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.38669<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.82969
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">20</span>%<span class="p">|</span>█████████▊<span class="w">                                       </span><span class="p">|</span><span class="w"> </span><span class="m">2</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:01&lt;<span class="m">00</span>:04,<span class="w">  </span><span class="m">1</span>.87epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.26822<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.13899<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.38669
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">30</span>%<span class="p">|</span>██████████████▋<span class="w">                                  </span><span class="p">|</span><span class="w"> </span><span class="m">3</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:01&lt;<span class="m">00</span>:03,<span class="w">  </span><span class="m">2</span>.21epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">3</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.10167<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.06073<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.13899
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">40</span>%<span class="p">|</span>███████████████████▌<span class="w">                             </span><span class="p">|</span><span class="w"> </span><span class="m">4</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:01&lt;<span class="m">00</span>:02,<span class="w">  </span><span class="m">2</span>.43epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">4</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.05216<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.05481<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.06073
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">50</span>%<span class="p">|</span>████████████████████████▌<span class="w">                        </span><span class="p">|</span><span class="w"> </span><span class="m">5</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:01&lt;<span class="m">00</span>:01,<span class="w">  </span><span class="m">2</span>.59epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">5</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.04968<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.04911<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.05481
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">60</span>%<span class="p">|</span>█████████████████████████████▍<span class="w">                   </span><span class="p">|</span><span class="w"> </span><span class="m">6</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:02&lt;<span class="m">00</span>:01,<span class="w">  </span><span class="m">2</span>.70epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">6</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.04377<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.03427<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.04911
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">70</span>%<span class="p">|</span>██████████████████████████████████▎<span class="w">              </span><span class="p">|</span><span class="w"> </span><span class="m">7</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:02&lt;<span class="m">00</span>:01,<span class="w">  </span><span class="m">2</span>.78epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">7</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.02903<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.02640<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.03427
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">80</span>%<span class="p">|</span>███████████████████████████████████████▏<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">8</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:02&lt;<span class="m">00</span>:00,<span class="w">  </span><span class="m">2</span>.85epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">8</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.02037<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.01951<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.02640
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w">  </span><span class="m">90</span>%<span class="p">|</span>████████████████████████████████████████████<span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="m">9</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:03&lt;<span class="m">00</span>:00,<span class="w">  </span><span class="m">2</span>.91epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Epoch<span class="w"> </span><span class="m">9</span>:<span class="w"> </span>train<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.01788<span class="p">;</span><span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.01563<span class="p">;</span><span class="w"> </span>best<span class="w"> </span>validation<span class="w"> </span><span class="nv">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.01951
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/best_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Model<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/mgn/training_output/last_model.pt&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training:<span class="w"> </span><span class="m">100</span>%<span class="p">|</span>████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">10</span>/10<span class="w"> </span><span class="o">[</span><span class="m">00</span>:03&lt;<span class="m">00</span>:00,<span class="w">  </span><span class="m">2</span>.59epochs/s<span class="w"> </span><span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>model:<span class="w"> </span><span class="m">3</span>.886<span class="w"> </span>seconds<span class="w"> </span>/<span class="w"> </span><span class="m">0</span>.065<span class="w"> </span>minutes
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Minimum<span class="w"> </span>validation<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01563
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Minimum<span class="w"> </span>train<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01788
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Training<span class="w"> </span>Completed
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Total<span class="w"> </span>training<span class="w"> </span>time:<span class="w"> </span><span class="m">3</span>.886<span class="w"> </span>seconds<span class="w"> </span>/<span class="w"> </span><span class="m">0</span>.065<span class="w"> </span>minutes
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="s1">&#39;predict&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Predicting<span class="w"> </span>images<span class="w"> </span><span class="nv">frames</span><span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="nv">channels</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">size</span><span class="o">=(</span><span class="m">128</span>,<span class="w"> </span><span class="m">128</span><span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Predicting<span class="w"> </span><span class="s1">&#39;[&#39;</span>/home/ubuntu/mlsimkit/src/mlsimkit/datasets/ahmed-sample/downsampled_stls/ahmed_2_downsampled.stl<span class="s1">&#39;]&#39;</span>...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Comparing<span class="w"> </span>predictions<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-1.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Result<span class="w"> </span>metrics:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;mse&#39;</span>:<span class="w"> </span><span class="m">0</span>.09749293327331543,<span class="w"> </span><span class="s1">&#39;mae&#39;</span>:<span class="w"> </span><span class="m">0</span>.29415807127952576,<span class="w"> </span><span class="s1">&#39;mape&#39;</span>:<span class="w"> </span><span class="m">1</span>.5071260929107666,<span class="w"> </span><span class="s1">&#39;msle&#39;</span>:<span class="w"> </span><span class="m">0</span>.04913759604096413,<span class="w"> </span><span class="s1">&#39;psnr&#39;</span>:<span class="w"> </span><span class="m">7</span>.912767988920114<span class="o">}</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Predicting<span class="w"> </span><span class="s1">&#39;[&#39;</span>/home/ubuntu/mlsimkit/src/mlsimkit/datasets/ahmed-sample/downsampled_stls/ahmed_7_downsampled.stl<span class="s1">&#39;]&#39;</span>...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Comparing<span class="w"> </span>predictions<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/slices/slice-group-6.npy&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Result<span class="w"> </span>metrics:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;mse&#39;</span>:<span class="w"> </span><span class="m">0</span>.09737907350063324,<span class="w"> </span><span class="s1">&#39;mae&#39;</span>:<span class="w"> </span><span class="m">0</span>.2937178909778595,<span class="w"> </span><span class="s1">&#39;mape&#39;</span>:<span class="w"> </span><span class="m">1</span>.5132616758346558,<span class="w"> </span><span class="s1">&#39;msle&#39;</span>:<span class="w"> </span><span class="m">0</span>.04915590211749077,<span class="w"> </span><span class="s1">&#39;psnr&#39;</span>:<span class="w"> </span><span class="m">7</span>.917843709358413<span class="o">}</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Images<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/prediction/images&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Ground<span class="w"> </span>truth<span class="w"> </span>results<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/home/ubuntu/mlsimkit/quickstart/slices/prediction/results.jsonl&#39;</span>
</pre></div>
</div>
<p>When complete, the output directory <code class="docutils literal notranslate"><span class="pre">quickstart/slices/</span></code> contains the data from preprocessing and training and the results for prediction. Something like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>tree<span class="w"> </span>-L<span class="w"> </span><span class="m">2</span><span class="w"> </span>quickstart/slices
quickstart/slices
├──<span class="w"> </span>ae
│<span class="w">   </span>├──<span class="w"> </span>inference_output
│<span class="w">   </span>└──<span class="w"> </span>training_output
├──<span class="w"> </span>logs
│<span class="w">   </span>└──<span class="w"> </span>slices
├──<span class="w"> </span>mgn
│<span class="w">   </span>└──<span class="w"> </span>training_output
├──<span class="w"> </span>prediction
│<span class="w">   </span>├──<span class="w"> </span>geometry-group-0-prediction.npy
│<span class="w">   </span>├──<span class="w"> </span>geometry-group-5-prediction.npy
│<span class="w">   </span>├──<span class="w"> </span>images
│<span class="w">   </span>├──<span class="w"> </span>results.jsonl
│<span class="w">   </span>└──<span class="w"> </span>test-copy.manifest
├──<span class="w"> </span>slices
│<span class="w">   </span>├──<span class="w"> </span>slice-group-0.npy
│<span class="w">   </span>├──<span class="w"> </span>slice-group-1.npy
│<span class="w">   </span>├──<span class="w"> </span>slice-group-2.npy
│<span class="w">   </span>├──<span class="w"> </span>slice-group-3.npy
│<span class="w">   </span>├──<span class="w"> </span>slice-group-4.npy
│<span class="w">   </span>├──<span class="w"> </span>slice-group-5.npy
│<span class="w">   </span>└──<span class="w"> </span>slice-group-6.npy
├──<span class="w"> </span>slices-copy.manifest
├──<span class="w"> </span>train.manifest
├──<span class="w"> </span>validate.manifest
└──<span class="w"> </span>test.manifest
</pre></div>
</div>
</section>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Link to this heading">¶</a></h2>
<p>You have trained a Slices model from scratch on sample data. To view image results, open the images in <code class="docutils literal notranslate"><span class="pre">quickstart/slices/prediction/images/</span></code>. For each input geometry mesh, there are 10 slices. Each slice has the original image, predicted image, and an error image. The combined image conveniently stiches all three images together for quick viewing:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>tree<span class="w"> </span>quickstart/slices/prediction/images/
quickstart/slices/prediction/images/
├──<span class="w"> </span>geometry-group-0-combined-0.png
├──<span class="w"> </span>geometry-group-0-combined-1.png
├──<span class="w"> </span>geometry-group-0-combined-2.png
├──<span class="w"> </span>geometry-group-0-combined-3.png
├──<span class="w"> </span>...
├──<span class="w"> </span>geometry-group-0-combined-9.png
├──<span class="w"> </span>geometry-group-0-error-0.png
├──<span class="w"> </span>...
├──<span class="w"> </span>geometry-group-0-error-9.png
├──<span class="w"> </span>geometry-group-0-original-0.png
├──<span class="w"> </span>...
├──<span class="w"> </span>geometry-group-0-original-9.png
├──<span class="w"> </span>geometry-group-0-prediction-0.png
├──<span class="w"> </span>...
├──<span class="w"> </span>geometry-group-0-prediction-9.png
├──<span class="w"> </span>geometry-group-1-combined-0.png
├──<span class="w"> </span>...
</pre></div>
</div>
<p>The output combined images will look like the below. For the quickstart this will show inaccuracies due to reduced training data and training time:</p>
<a class="reference internal image-reference" href="../_images/geometry-group-0-combined-0.png"><img alt="Image of prediction output vs original ground truth" src="../_images/geometry-group-0-combined-0.png" style="width: 1000px;" />
</a>
<p>However, the <a class="reference internal" href="../tutorials/tutorial-slices-windsor.html#tutorial-slices-windsor"><span class="std std-ref">Slice Prediction Tutorial</span></a> has a much larger dataset and configuration to obtain more accurate results like this:</p>
<a class="reference internal image-reference" href="../_images/windsor-example-combined.png"><img alt="Figure 1. An example combined view comparing the original, reconstructed, and error" src="../_images/windsor-example-combined.png" style="width: 1000px; height: 166px;" />
</a>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">¶</a></h2>
<p>Follow the <a class="reference internal" href="../tutorials/tutorial-slices-windsor.html#tutorial-slices-windsor"><span class="std std-ref">Slice Prediction Tutorial</span></a> to train on a real large-scale dataset and make accurate predictions.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><!--
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/mlsimkit-sidebar.png" alt="MLSimKit logo" />
  </a>
</p>
-->

<h4><a href="../index.html">AI Surrogate Models in Engineering on AWS</a></h4>
<p>
  Tools to develop and use ML predictive models as surrogates for physics-based simulations.
</p>

<h4>Useful Links</h4>
<ul>
  <li><a href="install.html">Install</a></li>
  <li><a href="quickstart-kpi.html">Quickstart KPI</a></li>
  <li><a href="#">Quickstart Slices</a></li>
  <li><a href="quickstart-surface.html">Quickstart Surfaces</a></li>
  <li><a href="troubleshooting.html">Troubleshooting</a></li>
</ul>

<div id="native-ribbon">
</div>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart-kpi.html">Quickstart with KPI Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart-surface.html">Quickstart with Surface Variable Prediction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart with Slice Prediction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sample-dataset">Sample Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#external-datasets">External Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-sample">Run the Sample</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-on-gpu">Running on GPU</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#results">Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial-kpi-windsor.html">KPI Prediction Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial-surface-ahmed.html">Surface Variable Prediction Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial-slices-windsor.html">Slice Prediction Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../datasets/ahmed.html">AhmedML Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/windsor.html">WindsorML Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/drivaer.html">DrivAerML Dataset</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="user-guide-kpi.html">Model User Guide – KPI Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-guide-surface.html">Model User Guide – Surface Variable Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-guide-slice.html">Model User Guide – Slice Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebook-guide.html">Using the MLSimKit SDK Interactively (Notebooks, IPython)</a></li>
<li class="toctree-l1"><a class="reference internal" href="mlflow-guide.html">Tracking Experiments and Results with MLFLow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/guide.html">Code Structure and Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/learn.html">Learning Module (<code class="docutils literal notranslate"><span class="pre">mlsimkit.learn</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/cli-toolkit.html">Creating Custom CLI Commands</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/api.html">MLSimKit SDK API</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="quickstart-surface.html" title="previous chapter">Quickstart with Surface Variable Prediction</a></li>
      <li>Next: <a href="troubleshooting.html" title="next chapter">Troubleshooting</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;Copyright 2025 Amazon.com, Inc. or its affiliates. All Rights Reserved..
      
      |
      <a href="../_sources/user/quickstart-slices.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>