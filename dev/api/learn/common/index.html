<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>mlsimkit.learn.common – MLSimKit Learn Common &#8212; AI Surrogate Models for Engineering on AWS 0.1.dev1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css?v=9de7e953" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=06097142" />
    <script src="../../../../_static/documentation_options.js?v=6aee1ebc"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="mlsimkit.learn.manifest – MLSimKit Learn Manifest" href="../manifest/index.html" />
    <link rel="prev" title="mlsimkit.common.cli.BaseGroup" href="../../cli/classes/mlsimkit.common.cli.BaseGroup.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="mlsimkit-learn-common-mlsimkit-learn-common">
<span id="api-learn-common"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">mlsimkit.learn.common</span></code> – MLSimKit Learn Common<a class="headerlink" href="#mlsimkit-learn-common-mlsimkit-learn-common" title="Link to this heading">¶</a></h1>
<p>This part of the documentation covers the common interfaces shared across use cases like KPI and Surface prediction models.</p>
<section id="training">
<h2>Training<a class="headerlink" href="#training" title="Link to this heading">¶</a></h2>
<p>The Training module contains the main training loop function <code class="docutils literal notranslate"><span class="pre">train()</span></code> and related helpers.</p>
<dl class="py class" id="module-mlsimkit.learn.common.training">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.ModelIO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">ModelIO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.ModelIO" title="Link to this definition">¶</a></dt>
<dd><p>Protocol for defining the interface for creating, loading, and saving models.</p>
<p>This protocol defines the methods that must be implemented by any class that conforms to the ModelIO interface.
The ModelIO interface is used to abstract the model creation, loading, and saving processes, allowing different
model architectures to be used without modifying the core training logic.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.ModelIO.None">
<span class="sig-name descname"><span class="pre">None</span></span><a class="headerlink" href="#mlsimkit.learn.common.training.ModelIO.None" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.ModelIO.new">
<span class="sig-name descname"><span class="pre">new</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.ModelIO.new" title="Link to this definition">¶</a></dt>
<dd><p>Create a new instance of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.ModelIO.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.ModelIO.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a saved model checkpoint.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.ModelIO.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.ModelIO.save" title="Link to this definition">¶</a></dt>
<dd><p>Save the model checkpoint.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.ModelIO.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.ModelIO.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.ModelIO._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#mlsimkit.learn.common.training.ModelIO._abc_impl" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.ModelIO._is_protocol">
<span class="sig-name descname"><span class="pre">_is_protocol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#mlsimkit.learn.common.training.ModelIO._is_protocol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Load a saved model checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>mlsimkit.learn.common.schema.training.BaseTrainSettings</em>) – The training configuration settings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model: The loaded model.</p></li>
<li><p>optimizer: The loaded optimizer.</p></li>
<li><p>start_epoch: The starting epoch for training.</p></li>
<li><p>train_losses: A list of training losses.</p></li>
<li><p>validation_losses: A list of validation losses.</p></li>
<li><p>best_validation_loss: The best validation loss value.</p></li>
<li><p>best_validation_loss_epoch: The epoch with the best validation loss.</p></li>
<li><p>best_model: The model with the best validation loss.</p></li>
<li><p>losses_df: A DataFrame containing the training and validation losses.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.nn.Module, torch.optim.Optimizer, int, list, list, float, int, torch.nn.Module, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">new</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd><p>Create a new instance of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new model instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd><p>Save the model checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model to save.</p></li>
<li><p><strong>model_path</strong> (<em>str</em><em> or </em><em>Path</em>) – The path to save the model checkpoint.</p></li>
<li><p><strong>train_loss</strong> (<em>torch.Tensor</em>) – The training loss.</p></li>
<li><p><strong>validation_loss</strong> (<em>torch.Tensor</em>) – The validation loss.</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – The optimizer used during training.</p></li>
<li><p><strong>epoch</strong> (<em>int</em>) – The current epoch number.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.fmt_state">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">fmt_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accelerator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.fmt_state" title="Link to this definition">¶</a></dt>
<dd><p>Format the state of the Accelerator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>accelerator</strong> (<em>Accelerator</em>) – The Accelerator instance.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the formatted state information.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.initialize">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseTrainSettings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accelerator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the training environment based on the provided configuration and accelerator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>BaseTrainSettings</em>) – The training configuration settings.</p></li>
<li><p><strong>accelerator</strong> (<em>Accelerator</em>) – The Accelerator instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The device to be used for training.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.is_distributed">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">is_distributed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.is_distributed" title="Link to this definition">¶</a></dt>
<dd><p>Check if the current execution environment is distributed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the execution environment is distributed, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.load_checkpoint_model">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">load_checkpoint_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modelio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.load_checkpoint_model" title="Link to this definition">¶</a></dt>
<dd><p>Load a checkpoint model from the provided configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modelio</strong> (<a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO" title="mlsimkit.learn.common.training.ModelIO"><em>ModelIO</em></a>) – The ModelIO instance for creating and loading models.</p></li>
<li><p><strong>config</strong> (<em>BaseTrainSettings</em>) – The training configuration settings.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If any of the required checkpoint paths are None.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model: The loaded model.</p></li>
<li><p>optimizer: The loaded optimizer.</p></li>
<li><p>start_epoch: The starting epoch for training.</p></li>
<li><p>train_losses: A list of training losses.</p></li>
<li><p>validation_losses: A list of validation losses.</p></li>
<li><p>best_validation_loss: The best validation loss value.</p></li>
<li><p>best_validation_loss_epoch: The epoch with the best validation loss.</p></li>
<li><p>best_model: The model with the best validation loss.</p></li>
<li><p>losses_df: A DataFrame containing the training and validation losses.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[torch.nn.Module, torch.optim.Optimizer, int, list, list, float, int, torch.nn.Module, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.make_accelerator">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">make_accelerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseTrainSettings</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.make_accelerator" title="Link to this definition">¶</a></dt>
<dd><p>Create an instance of the HuggingFace Accelerator for efficient training on various hardware configurations.</p>
<p>The HuggingFace Accelerator is a utility that simplifies the process of training deep learning models
on different hardware configurations, including CPUs, GPUs, and multi-GPU setups. It handles device
management, distributed training, mixed precision, and other performance optimizations automatically.</p>
<p>By using the Accelerator, MLSimKit can leverage efficient training on a wide range of hardware setups
without the need for extensive manual configuration and optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>BaseTrainSettings</em>) – The training configuration settings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The HuggingFace Accelerator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Accelerator</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.train">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modelio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO" title="mlsimkit.learn.common.training.ModelIO"><span class="pre">ModelIO</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Data</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseTrainSettings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_scaler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accelerator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Accelerator</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mlsimkit.learn.common.training.train" title="Link to this definition">¶</a></dt>
<dd><p>Train a model using the provided data loaders, loss function, and configuration.</p>
<p>This function encapsulates the core training loop for various machine learning models in MLSimKit.
It is designed to be generic and reusable across different use cases, such as KPI prediction,
surface variable prediction, and slice prediction.</p>
<p>The <cite>train</cite> function operates in conjunction with the <cite>ModelIO</cite> interface, which abstracts the
creation, loading, and saving of models. The <cite>ModelIO</cite> interface allows different model architectures
to be used for training without modifying the core training logic.</p>
<p>The training data and validation data are provided as PyTorch data loaders, which abstract
the data loading and preprocessing steps. This design allows for different data types and
preprocessing pipelines to be used for training, as long as they conform to the data loader
interface.</p>
<p>The training process involves the following steps:</p>
<ol class="arabic simple">
<li><p>Prepare the training and validation data loaders.</p></li>
<li><p>Initialize or load a model using the <cite>ModelIO</cite> interface.</p></li>
<li><p>Perform the training loop, iterating over epochs and updating the model weights.</p></li>
<li><p>Validate the model on the validation data loader after each epoch.</p></li>
<li><p>Save the best model and checkpoint models using the <cite>ModelIO</cite> interface.</p></li>
<li><p>Return the training and validation losses, the best model, and other relevant information.</p></li>
</ol>
<p>By leveraging the <cite>ModelIO</cite> interface, the <cite>train</cite> function can be used with different model
architectures without modifying its core implementation. The specific model architecture is
provided through the <cite>modelio</cite> argument, which must conform to the <cite>ModelIO</cite> protocol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modelio</strong> (<a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO" title="mlsimkit.learn.common.training.ModelIO"><em>ModelIO</em></a>) – The ModelIO instance for creating and loading models.</p></li>
<li><p><strong>train_loader</strong> (<em>torch.utils.data.DataLoader</em>) – The data loader for training data.</p></li>
<li><p><strong>validation_loader</strong> (<em>torch.utils.data.DataLoader</em>) – The data loader for validation data.</p></li>
<li><p><strong>calc_loss</strong> (<em>Callable</em><em>[</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch_geometric.data.Data</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em>) – The function to calculate the loss.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to use for training.</p></li>
<li><p><strong>config</strong> (<em>mlsimkit.learn.common.schema.training.BaseTrainSettings</em>) – The training configuration settings.</p></li>
<li><p><strong>model_name</strong> (<em>str</em>) – The name of the model.</p></li>
<li><p><strong>data_scaler</strong> (<em>DataScaler</em>) – The data scaler for normalizing data.</p></li>
<li><p><strong>accelerator</strong> (<em>accelerate.Accelerator</em>) – The HuggingFace Accelerator instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>validation_losses (list): A list of validation losses for each epoch.</p></li>
<li><p>train_losses (list): A list of training losses for each epoch.</p></li>
<li><p>best_model (torch.nn.Module): The model with the best validation loss.</p></li>
<li><p>model (torch.nn.Module): The final trained model.</p></li>
<li><p>best_validation_loss (float): The best validation loss achieved during training.</p></li>
<li><p>validation_loader (torch.utils.data.DataLoader): The data loader for validation data.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[list, list, torch.nn.Module, torch.nn.Module, float, torch.utils.data.DataLoader]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.validate">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_scaler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_loss</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.validate" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the validation loss of the model on the given data loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loader</strong> (<em>torch.utils.data.DataLoader</em>) – The data loader for validation data.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to use for validation.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model to validate.</p></li>
<li><p><strong>data_scaler</strong> (<em>DataScaler</em>) – The data scaler for normalizing data.</p></li>
<li><p><strong>calc_loss</strong> (<em>callable</em>) – The function to calculate the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total validation loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.training.validate_training_settings">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.training.</span></span><span class="sig-name descname"><span class="pre">validate_training_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseTrainSettings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.training.validate_training_settings" title="Link to this definition">¶</a></dt>
<dd><p>Validate the training settings configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>BaseTrainSettings</em>) – The training configuration settings.</p></li>
<li><p><strong>ctx</strong> (<em>click.Context</em>) – The Click context object.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>click.UsageError</strong> – If the configuration is invalid (e.g., using CPU with <cite>accelerate launch</cite>).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="tracking">
<h2>Tracking<a class="headerlink" href="#tracking" title="Link to this heading">¶</a></h2>
<p>The Tracking module wraps MLFlow to make it easier to track and report experiments.</p>
<dl class="py function" id="module-mlsimkit.learn.common.tracking">
<dt class="sig sig-object py" id="mlsimkit.learn.common.tracking.configure">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.tracking.</span></span><span class="sig-name descname"><span class="pre">configure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.tracking.configure" title="Link to this definition">¶</a></dt>
<dd><p>Configure MLFlow tracking for the given context.</p>
<p>This function configures MLFlow tracking for the main process and worker processes.
For the main process, it sets up the MLFlow experiment and run, and writes the run ID
to the project file. For worker processes, it waits for the main process to write the
run ID, and then configures MLFlow with the same run ID.</p>
<dl class="simple">
<dt>Warning: This assumes accelerate.Accelerator() has been initialized. If not, accelerate</dt><dd><p>settings will default since we get the PartialState() instance. For now, this
works because we are careful in the train CLI functions, but it’s brittle.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ctx</strong> (<em>click.Context</em>) – The click context object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.tracking.configure_mlflow">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.tracking.</span></span><span class="sig-name descname"><span class="pre">configure_mlflow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MLFlowConfig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.tracking.configure_mlflow" title="Link to this definition">¶</a></dt>
<dd><p>Configure MLFlow with the given settings.</p>
<p>This function sets up the MLFlow experiment and run based on the provided settings.
If an experiment with the given name does not exist, it creates a new experiment.
If a run is not already active, it starts a new run with the specified run ID (if provided).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>settings</strong> (<em>MLFlowConfig</em>) – The MLFlow configuration settings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated MLFlow configuration settings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MLFlowConfig</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.tracking.context">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.tracking.</span></span><span class="sig-name descname"><span class="pre">context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifact_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_root</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.tracking.context" title="Link to this definition">¶</a></dt>
<dd><p>Context manager for configuring MLFlow tracking.</p>
<p>This context manager sets the global ARTIFACT_ROOT and METRIC_ROOT variables,
configures MLFlow tracking, and restores the variables to their original values
when the context is exited.</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># MLFlow is configured with the tracking context</span>
<span class="k">with</span> <span class="n">tracking</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">artifact_root</span><span class="o">=</span><span class="s1">&#39;kpi/train&#39;</span><span class="p">,</span> <span class="n">metric_root</span><span class="o">=</span><span class="s1">&#39;kpi.train&#39;</span><span class="p">):</span>
    <span class="n">run_train</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> (<em>click.Context</em>) – The click context object.</p></li>
<li><p><strong>artifact_root</strong> (<em>str</em>) – The root path for artifact logging.</p></li>
<li><p><strong>metric_root</strong> (<em>str</em>) – The root path for metric logging.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.tracking.log_artifact_wrapper">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.tracking.</span></span><span class="sig-name descname"><span class="pre">log_artifact_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.tracking.log_artifact_wrapper" title="Link to this definition">¶</a></dt>
<dd><p>Wrap the mlflow.log_artifact or mlflow.log_artifacts function.</p>
<p>This decorator wraps the provided function to conditionally log artifacts
based on the should_log() function and generates a default artifact path.</p>
<p>For instance, when artifact path is NOT specified, the parents of the local path root are retained
relative to the project output root. By keeping the parents, the artifact path is unique just
like local output files. This depends on the Project output directory (OUTPUT_ROOT) and the
tracking context’s ARTIFACT_ROOT.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OUTPUT_ROOT</span> <span class="o">=</span> <span class="s2">&quot;outputs/training&quot;</span>
<span class="n">ARTIFACT_ROOT</span> <span class="o">=</span> <span class="s2">&quot;kpi/train&quot;</span>

<span class="c1"># Log a single file with a custom artifact path</span>
<span class="n">log_artifact</span><span class="p">(</span><span class="s2">&quot;/path/to/local/file.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;custom/artifact/path/file.txt&quot;</span><span class="p">)</span>

<span class="c1"># Log a directory with an automatically generated artifact path</span>
<span class="n">log_artifact</span><span class="p">(</span><span class="s2">&quot;outputs/training/path/to/local/dir&quot;</span><span class="p">)</span>  <span class="c1"># Artifact path will be &quot;kpi/train/path/to/local/dir&quot;</span>

<span class="c1"># Log a file with an automatically generated artifact path</span>
<span class="n">log_artifact</span><span class="p">(</span><span class="s2">&quot;outputs/training/path/to/local/file.txt&quot;</span><span class="p">)</span>  <span class="c1"># Artifact path will be &quot;kpi/train/path/to/local&quot;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to wrap (mlflow.log_artifact or mlflow.log_artifacts).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The wrapped function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.tracking.log_metric_wrapper">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.tracking.</span></span><span class="sig-name descname"><span class="pre">log_metric_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.tracking.log_metric_wrapper" title="Link to this definition">¶</a></dt>
<dd><p>Wrap the mlflow.log_metric and mlflow.log_param functions.</p>
<p>This decorator wraps the mlflow.log_metric/mlflow.log_param function to conditionally log metrics/params
based on the should_log() function and the global METRIC_ROOT setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The mlflow.log_metric or mlflow.log_param functions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The wrapped function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.tracking.log_metrics_wrapper">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.tracking.</span></span><span class="sig-name descname"><span class="pre">log_metrics_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.tracking.log_metrics_wrapper" title="Link to this definition">¶</a></dt>
<dd><p>Wrap the mlflow.log_metrics and mlflow.log_params functions.</p>
<p>This decorator wraps the mlflow.log_metric function to conditionally log metrics
based on the should_log() function and the global METRIC_ROOT setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The mlflow.log_metrics or mlflow.log_params functions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The wrapped function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.tracking.should_log">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.tracking.</span></span><span class="sig-name descname"><span class="pre">should_log</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.tracking.should_log" title="Link to this definition">¶</a></dt>
<dd><p>Determine if logging should be performed.</p>
<p>Logging should be performed in the following cases:
1. If MLFlow has been configured on start
2. If the Accelerate library is not initialized (i.e., not during training).
3. If the Accelerate library is initialized and it’s the main process (to avoid duplicate logging during training).</p>
<p>The Accelerate library is used for distributed training, and during training, only the main process should log
to MLflow to avoid duplicate logging from worker processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if logging should be performed, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="mesh-utilities">
<h2>Mesh Utilities<a class="headerlink" href="#mesh-utilities" title="Link to this heading">¶</a></h2>
<p>The Mesh module contains helpers for third-parties to process meshes such as down-sampling and format conversions.</p>
<dl class="py function" id="module-mlsimkit.learn.common.mesh">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.as_torch_data">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">as_torch_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_cell_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_node_positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Data</span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.as_torch_data" title="Link to this definition">¶</a></dt>
<dd><p>Convert mesh to PyTorch Geometric Data format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_list</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – List of paths to mesh files.</p></li>
<li><p><strong>label</strong> (<em>int</em><em>, </em><em>optional</em>) – Label for the mesh data. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>PyTorch Geometric Data object containing the mesh data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch_geometric.data.Data</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mesh1.stl&#39;</span><span class="p">,</span> <span class="s1">&#39;mesh2.stl&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">as_torch_data</span><span class="p">(</span><span class="n">mesh_paths</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Data(x=[2048, 7], edge_attr=[4096, 4], edge_index=[2, 4096], y=[1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.construct_processed_data">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">construct_processed_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_perc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">Data</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.construct_processed_data" title="Link to this definition">¶</a></dt>
<dd><p>Construct a generator that yields processed mesh data in PyTorch Geometric Data format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – List of paths to mesh files.</p></li>
<li><p><strong>labels</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of labels for the mesh data. If not provided, labels will be set to None.</p></li>
<li><p><strong>global_conditions</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of global conditions for the mesh data. If not provided, it will be set to None.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory to save the converted and downsampled mesh files. Defaults to the current directory.</p></li>
<li><p><strong>downsample_perc</strong> (<em>float</em><em>, </em><em>optional</em>) – Percentage of vertices to keep after downsampling (between 0 and 100). If not provided, no downsampling will be performed.</p></li>
<li><p><strong>num_processes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of processes to use for parallel processing. Defaults to 1 (single process).</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>torch_geometric.data.Data</em> – PyTorch Geometric Data object containing the mesh data.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mesh1.stl&#39;</span><span class="p">,</span> <span class="s1">&#39;mesh2.stl&#39;</span><span class="p">,</span> <span class="s1">&#39;mesh3.stl&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_generator</span> <span class="o">=</span> <span class="n">construct_processed_data</span><span class="p">(</span><span class="n">mesh_paths</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">downsample_perc</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">num_processes</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_generator</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Data(x=[1024, 7], edge_attr=[2048, 4], edge_index=[2, 2048], y=[0], mesh_path=[&#39;output/50perc_ds/mesh1_50perc_ds.stl&#39;], downsample_perc=50.0)</span>
<span class="go">Data(x=[2048, 7], edge_attr=[4096, 4], edge_index=[2, 4096], y=[1], mesh_path=[&#39;output/50perc_ds/mesh2_50perc_ds.stl&#39;], downsample_perc=50.0)</span>
<span class="go">Data(x=[1536, 7], edge_attr=[3072, 4], edge_index=[2, 3072], y=[0], mesh_path=[&#39;output/50perc_ds/mesh3_50perc_ds.stl&#39;], downsample_perc=50.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.convert">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.convert" title="Link to this definition">¶</a></dt>
<dd><p>Convert a mesh file to an STL file if the file extension is not supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – Path to the input mesh file.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Directory to save the converted STL file.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the file extension is not supported and there is no converter available.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the converted STL file, or the original file if it is already an STL.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Path</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;mesh.stl&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span>
<span class="go">Path(&#39;mesh.stl&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;mesh.vtp&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span>
<span class="go">Path(&#39;output/stl/mesh.stl&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.convert_vtp_to_stl">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">convert_vtp_to_stl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vtp_file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stl_file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.convert_vtp_to_stl" title="Link to this definition">¶</a></dt>
<dd><p>Convert a VTP file to an STL file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vtp_file_path</strong> (<em>Path</em>) – Path to the input VTP file.</p></li>
<li><p><strong>stl_file_path</strong> (<em>Path</em>) – Path to save the output STL file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the output STL file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_vtp_to_stl</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;mesh.vtp&#39;</span><span class="p">),</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;mesh.stl&#39;</span><span class="p">))</span>
<span class="go">Path(&#39;mesh.stl&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.downsample">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">downsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_mesh_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_perc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.downsample" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper to downsample a mesh file to the specified percentage and save the downsampled mesh to the output directory.
If downsample_perc is None, the original mesh file is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_mesh_filepath</strong> (<em>str</em>) – Path to the input mesh file.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Directory to save the downsampled mesh file.</p></li>
<li><p><strong>downsample_perc</strong> (<em>float</em><em>, </em><em>optional</em>) – Percentage of vertices to keep after downsampling (between 0 and 100).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If downsample_perc is not between 0 and 100.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the downsampled mesh file, or the original mesh file if downsample_perc is None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Path</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">downsample</span><span class="p">(</span><span class="s1">&#39;mesh.stl&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
<span class="go">Path(&#39;output/50perc_ds/mesh_50perc_ds.stl&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">downsample</span><span class="p">(</span><span class="s1">&#39;mesh.stl&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">Path(&#39;mesh.stl&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.downsample_mesh_file">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">downsample_mesh_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_perc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.downsample_mesh_file" title="Link to this definition">¶</a></dt>
<dd><p>Downsample a mesh file to the specified percentage and save the downsampled mesh to the output path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh_filepath</strong> (<em>str</em>) – Path to the input mesh file.</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – Path to save the downsampled mesh file.</p></li>
<li><p><strong>downsample_perc</strong> (<em>float</em>) – Percentage of vertices to keep after downsampling (between 0 and 100).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the downsampled mesh file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">downsample_mesh_file</span><span class="p">(</span><span class="s1">&#39;mesh.stl&#39;</span><span class="p">,</span> <span class="s1">&#39;downsampled_mesh.stl&#39;</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
<span class="go">Path(&#39;downsampled_mesh.stl&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.get_edges">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">get_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.get_edges" title="Link to this definition">¶</a></dt>
<dd><p>Get two-way mesh edges via mesh cell data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cells</strong> (<em>torch.Tensor</em>) – Tensor of mesh cell data (faces).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of two-way mesh edges.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cells</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_edges</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
<span class="go">tensor([[0, 1],</span>
<span class="go">        [1, 2],</span>
<span class="go">        [2, 0],</span>
<span class="go">        [2, 3],</span>
<span class="go">        [3, 4],</span>
<span class="go">        [4, 2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.load_mesh">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">load_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Trimesh</span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.load_mesh" title="Link to this definition">¶</a></dt>
<dd><p>Load a mesh from file. Always flattens if the file is a scene.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to the input mesh file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded mesh.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh.Trimesh</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">load_mesh</span><span class="p">(</span><span class="s1">&#39;mesh.stl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.load_mesh_files">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">load_mesh_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.mesh.load_mesh_files" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.load_mesh_files_pyvista">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">load_mesh_files_pyvista</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.mesh.load_mesh_files_pyvista" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.normalize_points">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">normalize_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_node_positions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.mesh.normalize_points" title="Link to this definition">¶</a></dt>
<dd><p>Normalize a numpy array of 3D points so that they fit within the cube [-1, 1] in all dimensions,
while maintaining the shape and aspect ratio of the original distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>original_node_positions</strong> (<em>np.ndarray</em>) – A 2D numpy array where each row represents a 3D point (x, y, z).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array of normalized 3D points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original_node_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalize_points</span><span class="p">(</span><span class="n">original_node_positions</span><span class="p">)</span>
<span class="go">array([[ 0.          1.         -0.55555556],</span>
<span class="go">       [ 0.44444444 -0.55555556  0.33333333],</span>
<span class="go">       [ 0.66666667  0.55555556 -0.11111111],</span>
<span class="go">       [-0.66666667 -1.          0.55555556]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.mesh.process_mesh">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.mesh.</span></span><span class="sig-name descname"><span class="pre">process_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Data</span></span></span><a class="headerlink" href="#mlsimkit.learn.common.mesh.process_mesh" title="Link to this definition">¶</a></dt>
<dd><p>Pre-process a list of mesh files by converting and downsampling them, and convert them to PyTorch Geometric Data format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>str</em><em>, </em><em>int</em><em>, </em><em>Optional</em><em>[</em><em>float</em><em>]</em><em>]</em>) – A tuple containing:
- path_num (int): Index of the current file being processed.
- path_list (List[str]): List of paths to mesh files.
- label (Optional[int]): Label for the mesh data.
- output_dir (str): Directory to save the converted and downsampled mesh files.
- total_files (int): Total number of files to be processed.
- downsample_perc (Optional[float]): Percentage of vertices to keep after downsampling (between 0 and 100).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>PyTorch Geometric Data object containing the mesh data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch_geometric.data.Data</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mesh1.stl&#39;</span><span class="p">,</span> <span class="s1">&#39;mesh2.stl&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mesh_paths</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">process_mesh</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Data(x=[1024, 7], edge_attr=[2048, 4], edge_index=[2, 2048], y=[1], mesh_path=[&#39;output/50perc_ds/mesh1_50perc_ds.stl&#39;, &#39;output/50perc_ds/mesh2_50perc_ds.stl&#39;], downsample_perc=50.0)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="miscellaneous-utilities">
<h2>Miscellaneous Utilities<a class="headerlink" href="#miscellaneous-utilities" title="Link to this heading">¶</a></h2>
<p>The Utils module collects mostly unrelated functions that should eventually be moved into specifically-named modules.</p>
<dl class="py function" id="module-mlsimkit.learn.common.utils">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.calculate_directional_correctness">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_directional_correctness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_results_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpi_idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.utils.calculate_directional_correctness" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.calculate_error_metrics">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_error_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpi_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.utils.calculate_error_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.calculate_mean_stddev">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_mean_stddev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mlsimkit.learn.common.utils.calculate_mean_stddev" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the mean and std deviation for each specified key in a dataset using an online algorithm.</p>
<p>This function avoids keeping the entire dataset in memory by computing the cumulative mean and standard deviation
for each key using “Parallel Algorithm” from <a class="reference external" href="https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Parallel_algorithm">https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Parallel_algorithm</a>).</p>
<p>By default, the first dimension is used for calculations and the second dimension determines
the output shape. You may override the default behavior for a specific key by
setting <code class="docutils literal notranslate"><span class="pre">dims</span></code> and/or <code class="docutils literal notranslate"><span class="pre">shape</span></code> respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – The dataset to normalize.</p></li>
<li><p><strong>keys</strong> (<em>Tuple</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The keys to normalize, defaults to (“x”).</p></li>
<li><p><strong>dims</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Optional dictionary specifying the dimension along
which to compute the statistics for each key. If not provided or if a key is
not present in the dictionary, the default dimension is 0.</p></li>
<li><p><strong>shapes</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Union</em><em>[</em><em>[</em><em>]</em><em>, </em><em>Tuple</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional dictionary specifying
the target shape for each key after computing the statistics. The default shape
is the second dimension (i.e., <cite>dataset[0][key].shape[1]</cite>). If an empty
tuple <cite>()</cite> or an empty list <cite>[]</cite> is specified for a key, the tensor associated
with that key will be flattened to a scalar (len=0) before returning
the statistics.</p></li>
<li><p><strong>device</strong> – The torch device to conduct the calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing two dictionaries:</dt><dd><ol class="arabic simple">
<li><p>The cumulative means for each key, with the specified target shape.</p></li>
<li><p>The cumulative standard deviations for each key, with the specified target shape.</p></li>
</ol>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Dict[str, torch.Tensor], Dict[str, torch.Tensor]]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute mean and std dev for &#39;x&#39; key with default dimensions and shapes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="p">,</span> <span class="n">stds</span> <span class="o">=</span> <span class="n">calculate_mean_stddev</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute mean and std dev for &#39;y&#39; along the third dimension (index 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="p">,</span> <span class="n">stds</span> <span class="o">=</span> <span class="n">calculate_mean_stddev</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Flatten &#39;y&#39; before computing mean and std dev</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="p">,</span> <span class="n">stds</span> <span class="o">=</span> <span class="n">calculate_mean_stddev</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">shapes</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[]})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute mean and std dev for &#39;y&#39; along the third dimension (index 2), and return a flattened tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="p">,</span> <span class="n">stds</span> <span class="o">=</span> <span class="n">calculate_mean_stddev</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">shapes</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[]})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.get_lr_scheduler">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">get_lr_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.utils.get_lr_scheduler" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.get_optimizer">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">get_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.utils.get_optimizer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.save_dataset">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">save_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.utils.save_dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.save_loss_plots">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">save_loss_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.utils.save_loss_plots" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.save_pred_vs_actual_plot">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">save_pred_vs_actual_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actuals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpi_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.utils.save_pred_vs_actual_plot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlsimkit.learn.common.utils.save_prediction_results">
<span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.utils.</span></span><span class="sig-name descname"><span class="pre">save_prediction_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpi_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_path_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual_dicts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_dicts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth_exist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsimkit.learn.common.utils.save_prediction_results" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="schemas">
<h2>Schemas<a class="headerlink" href="#schemas" title="Link to this heading">¶</a></h2>
<p>The learning schemas implement common data classes used across the codebase.</p>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.optimizer.</span></span><span class="sig-name descname"><span class="pre">LearningRateScheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">REDUCDE_LR_ON_PLATEAU</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'reducelronplateau'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">STEP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'step'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.optimizer.</span></span><span class="sig-name descname"><span class="pre">OptimizerAlgorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ADAGRAD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'adagrad'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ADAM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'adam'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ADAMW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'adamw'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">RMSPROP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rmsprop'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">SGD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sgd'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.optimizer.</span></span><span class="sig-name descname"><span class="pre">OptimizerSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OptimizerAlgorithm</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">OptimizerAlgorithm.ADAMW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ge</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">ge</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Gt</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">gt</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ge</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">ge</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Le</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">le</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LearningRateScheduler</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Gt</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">gt</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Le</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">le</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ge</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">ge</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking_metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TrackingMetric</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TrackingMetric.MIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ge</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">ge</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ge</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">ge</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5e-05</span></span></em><span class="sig-paren">)</span></dt>
<dd><dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Config</span></span></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Training</span> <span class="pre">Optimizer</span> <span class="pre">Settings'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">algorithm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OptimizerAlgorithm</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">decay_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">lr_scheduler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">LearningRateScheduler</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">min_lr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'title':</span> <span class="pre">'Training</span> <span class="pre">Optimizer</span> <span class="pre">Settings'}</span></em></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">momentum</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">patience_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">step_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">tracking_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">TrackingMetric</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">weight_decay</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.optimizer.</span></span><span class="sig-name descname"><span class="pre">TrackingMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">MAX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'max'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">MIN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'min'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.project.</span></span><span class="sig-name descname"><span class="pre">BaseProjectContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Data class for persisting state to disk between mlsimkit-learn commands.
Used to chain commands. Safe for multi-processing via ‘accelerate launch`.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">outdir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exist_ok</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.training.</span></span><span class="sig-name descname"><span class="pre">BaseTrainSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_output_dir:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs:</span> <span class="pre">~typing.Annotated[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size:</span> <span class="pre">~typing.Annotated[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_last:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_data_each_epoch:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device:</span> <span class="pre">~mlsimkit.learn.common.schema.training.Device</span> <span class="pre">=</span> <span class="pre">Device.AUTO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_save_interval:</span> <span class="pre">~typing.Annotated[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_loss_save_interval:</span> <span class="pre">~typing.Annotated[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixed_precision:</span> <span class="pre">~mlsimkit.learn.common.schema.training.MixedPrecision</span> <span class="pre">=</span> <span class="pre">MixedPrecision.NO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_checkpoint:</span> <span class="pre">~mlsimkit.learn.common.schema.training.LoadCheckpointSettings</span> <span class="pre">=</span> <span class="pre">LoadCheckpointSettings(checkpoint_path=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_checkpoint_path=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_path=None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer:</span> <span class="pre">~mlsimkit.learn.common.schema.optimizer.OptimizerSettings</span> <span class="pre">=</span> <span class="pre">OptimizerSettings(algorithm=&lt;OptimizerAlgorithm.ADAMW:</span> <span class="pre">'adamw'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate=0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum=0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_rate=0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking_metric=&lt;TrackingMetric.MIN:</span> <span class="pre">'min'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience_epochs=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lr=5e-05)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_cache:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_encoder_hidden_size:</span> <span class="pre">~typing.Annotated[int</span> <span class="pre">|</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_encoder_hidden_size:</span> <span class="pre">~typing.Annotated[int</span> <span class="pre">|</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_message_passing_mlp_hidden_size:</span> <span class="pre">~typing.Annotated[int</span> <span class="pre">|</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_message_passing_mlp_hidden_size:</span> <span class="pre">~typing.Annotated[int</span> <span class="pre">|</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_decoder_hidden_size:</span> <span class="pre">~typing.Annotated[int</span> <span class="pre">|</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~annotated_types.Ge(ge=1)]</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">checkpoint_save_interval</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">deterministic</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Device</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">drop_last</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">edge_encoder_hidden_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">edge_message_passing_mlp_hidden_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">empty_cache</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">LoadCheckpointSettings</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mixed_precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">MixedPrecision</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'protected_namespaces':</span> <span class="pre">()}</span></em></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">node_decoder_hidden_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">node_encoder_hidden_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">node_message_passing_mlp_hidden_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">optimizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OptimizerSettings</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">shuffle_data_each_epoch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">training_output_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">validation_loss_save_interval</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.training.</span></span><span class="sig-name descname"><span class="pre">Device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">AUTO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'auto'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">CPU</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'cpu'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.training.</span></span><span class="sig-name descname"><span class="pre">GlobalConditionMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">MODEL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'model'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">NODE_FEATURES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'node_features'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.training.</span></span><span class="sig-name descname"><span class="pre">LoadCheckpointSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_checkpoint_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Config</span></span></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Checkpoint</span> <span class="pre">Loading</span> <span class="pre">Settings'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">best_checkpoint_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">checkpoint_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">loss_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#mlsimkit.learn.common.training.ModelIO.None" title="mlsimkit.learn.common.training.ModelIO.None"><span class="pre">None</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'title':</span> <span class="pre">'Checkpoint</span> <span class="pre">Loading</span> <span class="pre">Settings'}</span></em></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.training.</span></span><span class="sig-name descname"><span class="pre">LossMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">MSE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mse'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">RMSE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rmse'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.training.</span></span><span class="sig-name descname"><span class="pre">MixedPrecision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">BF16</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bf16'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">FP16</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'fp16'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">NO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'no'</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsimkit.learn.common.schema.training.</span></span><span class="sig-name descname"><span class="pre">PoolingType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">MAX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'max'</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">MEAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mean'</span></em></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><!--
<p class="logo">
  <a href="../../../../index.html">
    <img class="logo" src="../../../../_static/mlsimkit-sidebar.png" alt="MLSimKit logo" />
  </a>
</p>
-->

<h4><a href="../../../../index.html">AI Surrogate Models in Engineering on AWS</a></h4>
<p>
  Tools to develop and use ML predictive models as surrogates for physics-based simulations.
</p>

<h4>Useful Links</h4>
<ul>
  <li><a href="../../../../user/install.html">Install</a></li>
  <li><a href="../../../../user/quickstart-kpi.html">Quickstart KPI</a></li>
  <li><a href="../../../../user/quickstart-slices.html">Quickstart Slices</a></li>
  <li><a href="../../../../user/quickstart-surface.html">Quickstart Surfaces</a></li>
  <li><a href="../../../../user/troubleshooting.html">Troubleshooting</a></li>
</ul>

<div id="native-ribbon">
</div>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/quickstart-kpi.html">Quickstart with KPI Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/quickstart-surface.html">Quickstart with Surface Variable Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/quickstart-slices.html">Quickstart with Slice Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/tutorial-kpi-windsor.html">KPI Prediction Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/tutorial-surface-ahmed.html">Surface Variable Prediction Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/tutorial-slices-windsor.html">Slice Prediction Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../datasets/ahmed.html">AhmedML Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datasets/windsor.html">WindsorML Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datasets/drivaer.html">DrivAerML Dataset</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/user-guide-kpi.html">Model User Guide – KPI Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/user-guide-surface.html">Model User Guide – Surface Variable Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/user-guide-slice.html">Model User Guide – Slice Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/notebook-guide.html">Using the MLSimKit SDK Interactively (Notebooks, IPython)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/mlflow-guide.html">Tracking Experiments and Results with MLFLow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../guide.html">Code Structure and Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../learn.html">Learning Module (<code class="docutils literal notranslate"><span class="pre">mlsimkit.learn</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli-toolkit.html">Creating Custom CLI Commands</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../api.html">MLSimKit SDK API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../cli/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mlsimkit.common.cli</span></code> – CLI Framework</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mlsimkit.learn.common</span></code> – MLSimKit Learn Common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking">Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mesh-utilities">Mesh Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miscellaneous-utilities">Miscellaneous Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#schemas">Schemas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manifest/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mlsimkit.learn.manifest</span></code> – MLSimKit Learn Manifest</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../api.html">MLSimKit SDK API</a><ul>
      <li>Previous: <a href="../../cli/classes/mlsimkit.common.cli.BaseGroup.html" title="previous chapter">mlsimkit.common.cli.BaseGroup</a></li>
      <li>Next: <a href="../manifest/index.html" title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mlsimkit.learn.manifest</span></code> – MLSimKit Learn Manifest</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;Copyright 2025 Amazon.com, Inc. or its affiliates. All Rights Reserved..
      
      |
      <a href="../../../../_sources/dev/api/learn/common/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>